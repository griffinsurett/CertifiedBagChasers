---
// src/layouts/collections/DiscordProductLayout.astro
/**
 * Discord Product Layout
 *
 * Keeps the existing Membership hero experience,
 * but uses the course-style content container below the hero.
 */
import BaseLayout from "@/layouts/BaseLayout.astro";
import FrontPageHeroWide from "@/layouts/FrontPageHeroWide.astro";
import ProductBottomCta from "@/components/ProductBottomCta.astro";
import type { CollectionLayoutProps } from "./types";

const {
  entry,
  collection,
  collectionMeta,
  Content,
  isIndexPage,
  seoProps = {},
  ...extraProps
} = Astro.props as CollectionLayoutProps;

const data = entry?.data || {};
const productDescription = data.longDescription ?? data.description;

const heroHeading =
  data.heading ??
  (data.title
    ? { before: "Join the", text: data.title }
    : { before: "Join the", text: "Community" });

const heroEyebrow =
  data.status === "coming-soon" ? "Coming Soon" : "Membership Access";

const primaryCTA = data.link
  ? { text: data.ctaText || "Join Now", link: data.link }
  : undefined;

const secondaryCTA = { text: "See What's Inside", link: "#membership-details" };
const productCta = data.cta ?? {};
---

<BaseLayout {...seoProps}>
  <main id="product-top" class="flex-1">
    <FrontPageHeroWide
      eyebrow={heroEyebrow}
      heading={heroHeading}
      description={productDescription}
      image={data.bannerImage || data.featuredImage}
      primaryCTA={primaryCTA}
      secondaryCTA={secondaryCTA}
    />

    <section id="membership-details" class="py-16 md:py-24 bg-bg">
      <div class="w-90/100 mx-auto">
        {
          Content ? (
            <Content />
          ) : (
            <section id="about" class="scroll-mt-36">
              <h2 class="text-3xl md:text-4xl font-extrabold text-white mb-5">
                About {data.title}
              </h2>
              <p class="text-text-secondary text-lg leading-relaxed max-w-[900px]">
                {productDescription}
              </p>
            </section>
          )
        }
      </div>
    </section>

    <ProductBottomCta
      eyebrow={productCta.eyebrow}
      title={productCta.title}
      description={productCta.description}
      ctaText={productCta.ctaText}
      ctaLink="#product-top"
    />
  </main>
</BaseLayout>
