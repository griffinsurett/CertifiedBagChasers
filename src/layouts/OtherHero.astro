---
// src/layouts/OtherHero.astro
/**
 * Other Hero Layout
 *
 * Two-column hero section with gradient background (no image).
 * Features:
 * - Dark gradient background with gold/green accents
 * - Two-column layout: text on left, empty slot on right
 * - Big text heading with eyebrow/highlight/after pattern
 * - Badge for status (coming soon, most popular, premium)
 * - Description and optional price
 * - Decorative lines overlay
 * - Right slot for additional content
 */
import BackgroundMedia from "@/components/BackgroundMedia.astro";

export interface Props {
  title: string;
  description?: string;
  heading?: string | { before?: string; text?: string; after?: string };
  image?: any;
  price?: string;
  priceNote?: string;
  status?: "available" | "coming-soon" | "free";
  tags?: string[];
  className?: string;
  minHeight?: string;
  singleColumn?: boolean;
}

const {
  title,
  description,
  heading,
  image,
  price,
  priceNote,
  status = "available",
  tags = [],
  className = "",
  minHeight = "100vh",
  singleColumn = false,
} = Astro.props;

// OtherHero display contract:
// - heading: top white line
// - title: bottom gold line
// Keep a fallback for legacy object-shaped heading values.
const headingText =
  typeof heading === "string"
    ? heading
    : heading?.before || heading?.text || heading?.after;

const isMostPopular = tags?.includes("most-popular");
const isComingSoon = status === "coming-soon";
const isPremiumOffering = tags?.includes("premium-offering");

// Check if there's content in the right slot
const hasRightSlot = Astro.slots.has("right");
const showRightColumn = hasRightSlot && !singleColumn;
const hasUnderDescriptionSlot = Astro.slots.has("under-description");
const hasUnderHeroOverlapSlot = Astro.slots.has("under-hero-overlap");
const hasBackgroundImage = Boolean(image);

const backgroundMedia = hasBackgroundImage
  ? {
      image: {
        src: image,
        imageClass: "bg-fixed",
        aboveTheFold: true,
      },
      overlayClass: "bg-black/75",
    }
  : undefined;
---

<section class:list={["relative", className, !hasBackgroundImage && "hero-gradient"]}>
  <div
    class="relative flex items-center overflow-hidden w-full py-16 md:py-24"
    style={`min-height: ${minHeight}`}
  >
    {backgroundMedia && <BackgroundMedia backgroundMedia={backgroundMedia} />}

    {/* Decorative lines overlay */}
    <div class="hero-lines absolute inset-0 z-[1] opacity-10 pointer-events-none"></div>

    {/* Two-column layout - always two columns */}
    <div class="relative z-10 w-90/100 mx-auto mt-10 md:mt-4">
      <div class:list={[
        "grid grid-cols-1 items-center",
        showRightColumn ? "lg:grid-cols-2 gap-12 lg:gap-16" : "",
      ]}>

        {/* Left Column - Text Content */}
        <div class="text-left">
          {/* Status Badge */}
          {isComingSoon && (
            <div class="inline-block bg-gradient-to-r from-accent-800 via-accent to-accent-100 text-bg py-1.5 px-4 rounded-full text-xs font-bold uppercase tracking-[1px] mb-4">
              üöÄ Coming Soon
            </div>
          )}

          {isMostPopular && !isComingSoon && (
            <div class="inline-block bg-gradient-to-r from-accent-800 via-accent to-accent-100 text-bg py-1.5 px-4 rounded-full text-xs font-bold uppercase tracking-[1px] mb-4">
              üî• Most Popular
            </div>
          )}

          {isPremiumOffering && !isComingSoon && !isMostPopular && (
            <div class="inline-block bg-gradient-to-r from-accent-800 via-accent to-accent-100 text-bg py-1.5 px-4 rounded-full text-xs font-bold uppercase tracking-[1px] mb-4">
              ‚≠ê Premium Offering
            </div>
          )}

          {/* Big Text Heading */}
          <h1 class="hero-heading text-[clamp(36px,6vw,80px)] leading-none mb-3">
            {headingText && (
              <span class="text-text block text-[clamp(18px,3vw,36px)] mb-2">{headingText}</span>
            )}
            <span class="gold-metallic-heading block">{title}</span>
          </h1>

          {/* Optional content directly under heading */}
          {Astro.slots.has("under-heading") && (
            <div class="mb-3">
              <slot name="under-heading" />
            </div>
          )}

          {/* Description */}
          {description && (
            <p class:list={[
              "text-lg md:text-xl text-text-secondary leading-relaxed",
              hasUnderDescriptionSlot ? "mb-3" : "mb-6",
            ]}>
              {description}
            </p>
          )}

          {/* Optional content directly under description */}
          {hasUnderDescriptionSlot && (
            <div class="mb-6">
              <slot name="under-description" />
            </div>
          )}

          {/* Price */}
          {price && (
            <div class="mb-6">
              <div class="text-4xl md:text-5xl font-extrabold text-white mb-2">
                {price}
              </div>
              {priceNote && (
                <span class="text-text-dim text-sm">
                  {priceNote}
                </span>
              )}
            </div>
          )}

          {/* Default slot for CTAs or additional content */}
          <slot />
        </div>

        {/* Right Column - Slot for additional content */}
        {showRightColumn && (
          <div class="flex items-center justify-center">
            <slot name="right" />
          </div>
        )}
      </div>
    </div>
  </div>
</section>

{/* Optional overlap slot rendered below hero with built-in negative margin */}
{hasUnderHeroOverlapSlot && (
  <div class="relative z-20 -mt-6 md:-mt-10 lg:w-90/100 mx-auto">
    <slot name="under-hero-overlap" />
  </div>
)}

<style>
  /* Hero gradient background */
  .hero-gradient {
    background:
      linear-gradient(135deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.9) 100%),
      radial-gradient(ellipse at bottom left, color-mix(in srgb, var(--color-accent) 15%, transparent) 0%, transparent 50%),
      radial-gradient(ellipse at top right, rgba(34,87,67,0.2) 0%, transparent 50%),
      #0a0a0a;
  }

  /* Decorative lines */
  .hero-lines {
    background:
      linear-gradient(45deg, transparent 40%, color-mix(in srgb, var(--color-accent) 30%, transparent) 45%, transparent 50%),
      linear-gradient(-45deg, transparent 40%, rgba(34, 87, 67, 0.3) 45%, transparent 50%);
  }

  /* Hero heading styles */
  .hero-heading {
    font-family: var(--font-display);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
  }

  /* Gold metallic heading gradient */
  .gold-metallic-heading {
    background: var(--gradient-gold-metallic);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    filter: drop-shadow(2px 3px 0px #2a1d05) drop-shadow(3px 6px 8px rgba(0, 0, 0, 0.7));
  }
</style>
