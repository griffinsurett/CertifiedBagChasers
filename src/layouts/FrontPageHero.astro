---
// src/layouts/FrontPageHero.astro
/**
 * Front Page Hero Layout
 *
 * Full-width hero section with gradient background for homepage.
 *
 * Features:
 * - Dark gradient background with gold/green accents
 * - Large centered text with metallic gold heading
 * - Primary and secondary CTAs
 * - Configurable minimum height (default 100vh)
 *
 * This is a layout component for landing pages.
 * Use directly in your homepage or marketing pages.
 */

import Button from "@/components/Button/Button";
import WhopRating from "@/components/WhopRating";
import BackgroundMedia from "@/components/BackgroundMedia.astro";
import { ctaData } from "@/content/siteData";
import BackgroundImg from "@/assets/inside-the-nyse.jpg";

export interface Props {
  title?: string;
  description?: string;
  eyebrow?: string;
  heading?: string | { before?: string; text?: string; after?: string };
  image?: any; // Astro image asset or public path
  video?: {
    src: string;
    autoPlay?: boolean;
    muted?: boolean;
    loop?: boolean;
    playsInline?: boolean;
    controls?: boolean;
    preload?: string;
  };
  primaryCTA?: {
    text: string;
    link: string;
  };
  secondaryCTA?: {
    text: string;
    link: string;
  };
  className?: string;
  id?: string;
  minHeight?: string;
}

const {
  title,
  description,
  eyebrow = "Financial Freedom Starts Here",
  heading,
  image,
  video,
  primaryCTA = {
    text: ctaData.text,
    link: ctaData.link,
  },
  secondaryCTA,
  className = "",
  id = "hero",
  minHeight = "100vh",
} = Astro.props;

const headingSource = heading ?? (title ? { text: title } : undefined);
const fallbackHeading = { before: "Stop Chasing", text: "Quick Fixes" };

const resolvedHeading = headingSource ?? fallbackHeading;
const eyebrowText = eyebrow;

const eyebrowLine = resolvedHeading && typeof resolvedHeading === "object" && "before" in resolvedHeading
  ? resolvedHeading.before
  : undefined;
const highlightLine = resolvedHeading && typeof resolvedHeading === "object" && "text" in resolvedHeading
  ? resolvedHeading.text
  : (typeof resolvedHeading === "string" ? resolvedHeading : undefined);
const afterLine = resolvedHeading && typeof resolvedHeading === "object" && "after" in resolvedHeading
  ? resolvedHeading.after
  : undefined;

const backgroundMedia = {
  image: {
    src: image || BackgroundImg,
    imageClass: "bg-fixed",
    aboveTheFold: true,
  },
  video: video
    ? {
        src: video.src,
        autoPlay: video.autoPlay ?? true,
        muted: video.muted ?? true,
        loop: video.loop ?? true,
        playsInline: video.playsInline ?? true,
        controls: video.controls ?? false,
        preload: video.preload ?? "metadata",
        videoClass: "object-cover",
      }
    : undefined,
  overlayClass: "bg-black/80",
};

const primaryIsExternal = primaryCTA?.link?.startsWith("http");
const secondaryIsExternal = secondaryCTA?.link?.startsWith("http");
---

<section id={id} class={`relative ${className}`}>
  <div
    class="relative flex flex-col items-center justify-center overflow-hidden px-5 hero-space text-center"
    style={`min-height: ${minHeight}`}
  >
    {/* Decorative lines overlay */}
    <div class="hero-lines absolute inset-0 opacity-10 pointer-events-none"></div>

    <BackgroundMedia backgroundMedia={backgroundMedia} />

    {/* Hero Content */}
    <div class="relative z-10 w-full max-w-4xl flex flex-col items-center space-y-5 mx-auto">
      {/* Badge */}
      <div class="bg-primary/15 border border-primary px-8 py-1.5 rounded-full">
        <span class="text-text font-semibold text-sm uppercase tracking-[2px]">
          ðŸ’° {eyebrowText}
        </span>
      </div>

      <h1 class="hero-heading text-[clamp(48px,8vw,100px)] leading-none max-w-[1000px]">
        {eyebrowLine && (
          <span class="text-text block">{eyebrowLine}</span>
        )}
        {highlightLine && (
          <span class="gold-metallic-heading block mt-1">{highlightLine}</span>
        )}
        {afterLine && (
          <span class="text-text block mt-1">{afterLine}</span>
        )}
      </h1>

      {
        description && (
          <p class="text-lg text-text-secondary max-w-[600px] leading-tight">
            {description}
          </p>
        )
      }

      {/* CTA Buttons */}
      <div class="flex gap-2 justify-center flex-wrap">
        {
          primaryCTA && (
            <Button
              href={primaryCTA.link}
              variant="primary"
              size="lg"
              target={primaryIsExternal ? "_blank" : undefined}
              rel={primaryIsExternal ? "noopener noreferrer" : undefined}
            >
              {primaryCTA.text}
            </Button>
          )
        }

        {
          secondaryCTA && (
            <Button
              href={secondaryCTA.link}
              variant="secondary"
              size="lg"
              target={secondaryIsExternal ? "_blank" : undefined}
              rel={secondaryIsExternal ? "noopener noreferrer" : undefined}
            >
              {secondaryCTA.text}
            </Button>
          )
        }
      </div>

      {/* Whop Rating */}
      <WhopRating client:visible className="mt-2" />
    </div>
  </div>

  {/* Optional slot for additional content below hero */}
  <slot />
</section>

<style>
  /* Hero gradient background */
  .hero-gradient {
    background:
      linear-gradient(135deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.9) 100%),
      radial-gradient(ellipse at bottom left, color-mix(in srgb, var(--color-accent) 15%, transparent) 0%, transparent 50%),
      radial-gradient(ellipse at top right, rgba(34,87,67,0.2) 0%, transparent 50%),
      #0a0a0a;
  }

  /* Decorative lines */
  .hero-lines {
    background:
      linear-gradient(45deg, transparent 40%, color-mix(in srgb, var(--color-accent) 30%, transparent) 45%, transparent 50%),
      linear-gradient(-45deg, transparent 40%, rgba(34, 87, 67, 0.3) 45%, transparent 50%);
  }

  /* Hero heading styles */
  .hero-heading {
    font-family: var(--font-display);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
  }

  /* Gold metallic heading gradient */
  .gold-metallic-heading {
    background: var(--gradient-gold-metallic);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    filter: drop-shadow(2px 3px 0px #2a1d05) drop-shadow(3px 6px 8px rgba(0, 0, 0, 0.7));
  }
</style>
