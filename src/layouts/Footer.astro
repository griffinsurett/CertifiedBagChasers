---
// src/layouts/Footer.astro
/**
 * Footer Component
 *
 * Site-wide footer with 4-column grid layout:
 * - Logo and description
 * - Quick Links
 * - Legal links
 * - Social media icons
 *
 * Bottom section has copyright and preferences.
 */
import { siteData } from "@/content/siteData";
import ContentRenderer from "@/components/ContentRenderer/ContentRenderer.astro";
import { query, sortBy } from "@/utils/query";
import PreferencesLayout from "./PreferencesLayout.astro";
import Logo from "@/components/Logo.astro";
import NewsletterForm from "@/components/Form/forms/NewsletterForm.astro";

// Query for quick links menu items
const quickLinksQuery = query("menu-items")
  .where((entry) => {
    const menus = entry.data.menu;
    if (Array.isArray(menus)) {
      return menus.some((m) => m.id === "quick-links");
    }
    return menus?.id === "quick-links";
  })
  .orderBy(sortBy("order", "asc"));

// Query for legal menu items
const legalQuery = query("menu-items")
  .where((entry) => {
    const menus = entry.data.menu;
    if (Array.isArray(menus)) {
      return menus.some((m) => m.id === "legal");
    }
    return menus?.id === "legal";
  })
  .orderBy(sortBy("order", "asc"));
---

<footer class="bg-bg-dark border-t border-primary/20 px-5 w-full mt-auto">
  <div class="mx-auto w-95/100">
    {/* Main Footer Grid */}
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-10 py-10">
      {/* Column 1: Logo & Description */}
      <div class="space-y-8">
        <div>
        <Logo shadow={false} className="w-60 h-auto mb-4" />
        <p class="text-text-muted leading-relaxed">
          Making wise money moves for long-term success. Every small step counts on the journey to financial freedom.
        </p>
        </div>
        <div>
          <h4 class="text-text mb-4 font-bold">Follow Us</h4>
          <ContentRenderer
            query={query("social-media")}
            variant="SocialMediaVariant"
            size="sm"
            alignment="left"
          />
        </div>
      </div>

      {/* Column 2: Quick Links */}
      <div class="space-y-6">
        <h4 class="text-text mb-4 font-bold">Quick Links</h4>
        <ContentRenderer
          query={quickLinksQuery}
          variant="ListVariant"
          layout="vertical"
          className="footer-links"
        />
         <ContentRenderer
          query={query("products")}
          variant="ListVariant"
          layout="vertical"
          className="footer-links"
        />
      </div>

      {/* Column 3: Legal & Preferences */}
      <div>
        <h4 class="text-text mb-4 font-bold">Legal</h4>
        <ContentRenderer
          query={legalQuery}
          variant="ListVariant"
          layout="vertical"
          className="footer-links"
        />
        <h4 class="text-text mb-4 mt-6 font-bold">Preferences</h4>
        <PreferencesLayout layout="vertical" className="footer-links" />
      </div>

      {/* Column 4: Newsletter + Social Media */}
      <div class="space-y-6">
        <NewsletterForm />
      </div>
    </div>

    {/* Bottom Section */}
    <div class="border-t border-primary/10 py-5">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4 text-text-secondary text-sm">
        <div class="flex items-center gap-2">
          &copy; {new Date().getFullYear()} {siteData.legalName}. All rights reserved.
        </div>
        <div>
          <span>
            Powered By{" "}
            <a
              href="https://griffinswebservices.com"
              class="hover:underline transition-all duration-300"
            >
              Griffin's Web Services
            </a>
          </span>
        </div>
      </div>
    </div>
  </div>
</footer>

<style>
  .footer-links :global(a),
  .footer-links :global(span),
  .footer-links :global(button) {
    color: var(--color-text-secondary);
    display: block;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    cursor: pointer;
    transition: color 0.3s;
  }
  .footer-links :global(a):hover,
  .footer-links :global(span):hover,
  .footer-links :global(button):hover {
    color: var(--color-primary);
  }
</style>
