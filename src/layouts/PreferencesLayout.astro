---
// src/layouts/PreferencesLayout.astro
/**
 * Preferences Layout
 *
 * Consolidates all user preference systems:
 * - Cookie consent (with script management)
 * - Accessibility preferences
 * - Language switcher (Google Translate)
 *
 * All use the same lazy-load, zero-impact pattern.
 * Styled to match footer menu links.
 */

// Cookie Consent Preferences
import CookiePreferencesButton from "@/integrations/preferences/consent/ui/CookiePreferencesButton";
import CookieConsentBanner from "@/integrations/preferences/consent/ui/CookieConsentBanner";
import ConsentScript from "@/integrations/preferences/consent/core/scripts/ConsentScript.astro";

// Accessibility Preferences
import AccessibilityButton from "@/integrations/preferences/accessibility/ui/AccessibilityButton";

// Button component
import Button from "@/components/Button/Button";

// Language Switcher
// import LanguageSwitcher from "@/integrations/preferences/language/ui/LanguageSwitcher";
// import BrowserTranslateScript from "@/integrations/preferences/language/core/scripts/BrowserTranslateScript.astro";

interface Props {
  layout?: "horizontal" | "vertical";
  className?: string;
}

const { layout = "vertical", className = "" } = Astro.props;

const layoutClasses = layout === "vertical" ? "flex-col items-start" : "flex-row flex-wrap items-center justify-center";
---

{/* Consent Script - Inline initialization, runs immediately */}
<ConsentScript />

{/* Browser Translation Script - Both native and Google enabled */}
<!-- <BrowserTranslateScript enableNative={true} enableGoogle={true} /> -->

<div class={`flex gap-2 ${layoutClasses} ${className}`}>
  {/* CCPA Opt-Out Link */}
  <Button href="/privacy-policy#ccpa-rights" variant="link">
    Do Not Sell My Info
  </Button>

  {/* Cookie Preferences Button - Client-side only */}
  <CookiePreferencesButton client:visible />

  {/* Accessibility Button - Client-side only */}
  <AccessibilityButton client:idle />

  {/* Language Switcher - Client-side only */}
  <!-- <LanguageSwitcher client:visible /> -->
</div>

<CookieConsentBanner client:idle />
